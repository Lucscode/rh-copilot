<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RH Copilot - Sistema Inteligente de GestÃ£o de Talentos</title>
  <link rel="stylesheet" href="/styles.css" />
  
  <!-- Script para injetar variÃ¡veis de ambiente do Vercel -->
  <script>
    // Injeta as variÃ¡veis de ambiente expostas pelo Vercel
    window.VITE_SUPABASE_URL = '%VITE_SUPABASE_URL%';
    window.VITE_SUPABASE_ANON_KEY = '%VITE_SUPABASE_ANON_KEY%';
    console.log('[Env] VariÃ¡veis injetadas do Vercel');
  </script>
</head>
<body>
  <!-- Header Principal -->
  <header class="main-header" id="main-header">
    <div class="header-content">
      <div class="logo">
        <h1>ğŸ¯ RH Copilot</h1>
      </div>
      <div id="user-info" class="user-info hidden">
        <span id="user-display"></span>
        <button id="logout-btn" class="btn-logout">Sair</button>
      </div>
    </div>
  </header>

  <!-- Sidebar + Main Container -->
  <div id="app">
    <!-- Sidebar de NavegaÃ§Ã£o -->
    <aside id="sidebar" class="sidebar hidden">
      <nav class="sidebar-nav">
        <div id="nav-rh" class="nav-section hidden">
          <h3>ğŸ“Š GestÃ£o & Analytics</h3>
          <a href="#" data-view="rh-dashboard" class="nav-item">ğŸ“ˆ Dashboard Gerencial</a>
          <a href="#" data-view="rh-metrics" class="nav-item">ğŸ“Š MÃ©tricas</a>
          
          <h3>ğŸ‘¥ GestÃ£o de Pessoas</h3>
          <a href="#" data-view="rh-employees" class="nav-item">ğŸ‘¤ FuncionÃ¡rios</a>
          <a href="#" data-view="rh-teams" class="nav-item">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Equipes</a>
          
          <h3>ğŸ”§ OperaÃ§Ãµes</h3>
          <a href="#" data-view="rh-service-orders" class="nav-item">ğŸ› ï¸ Ordens de ServiÃ§o</a>
          <a href="#" data-view="rh-feed" class="nav-item">ğŸ”” Feed de Atividades</a>
          <a href="#" data-view="rh-documents" class="nav-item">ğŸ“ Documentos IA</a>
        </div>

        <div id="nav-funcionario" class="nav-section hidden">
          <h3>ğŸ  Meu EspaÃ§o</h3>
          <a href="#" data-view="employee-dashboard" class="nav-item">ğŸ“Š Dashboard</a>
          <a href="#" data-view="employee-profile" class="nav-item">ğŸ‘¤ Meu Perfil</a>
          <a href="#" data-view="employee-requests" class="nav-item">ğŸ“ SolicitaÃ§Ãµes</a>
          <a href="#" data-view="employee-timesheet" class="nav-item">â° Registro de Ponto</a>
          <a href="#" data-view="employee-goals" class="nav-item">ğŸ¯ Metas & Desempenho</a>
          <a href="#" data-view="employee-documents" class="nav-item">ğŸ“ Meus Documentos</a>
          <a href="#" data-view="employee-chat" class="nav-item">ğŸ¤– Chat com IA</a>
        </div>

        <div id="nav-admin" class="nav-section hidden">
          <h3>AdministraÃ§Ã£o</h3>
          <a href="#" data-view="admin-dashboard" class="nav-item">ğŸ“ˆ Dashboard Admin</a>
          <a href="#" data-view="admin-users" class="nav-item">ğŸ‘¥ Gerenciar UsuÃ¡rios</a>
          <a href="#" data-view="admin-system" class="nav-item">âš™ï¸ ConfiguraÃ§Ãµes Sistema</a>
        </div>
      </nav>
    </aside>

    <!-- Ãrea Principal -->
    <main class="main-content">
    
    <!-- 1. AUTH VIEW -->
    <section id="auth-view" class="view active">
      <div class="auth-container">
        <div class="auth-box">
          <h2>Bem-vindo ao RH Copilot</h2>
          <p class="subtitle">Sistema Inteligente de GestÃ£o de Talentos</p>
          
          <div class="auth-tabs">
            <button class="tab-btn active" data-tab="login">Login</button>
            <button class="tab-btn" data-tab="register">Registrar</button>
          </div>

          <!-- Login Form -->
          <form id="login-form" class="auth-form active">
            <label>
              Email
              <input type="email" name="email" placeholder="seu.email@exemplo.com" required />
            </label>
            <label class="password-field">
              Senha
              <div class="password-wrapper">
                <input type="password" name="password" placeholder="Sua senha" required />
                <button type="button" class="toggle-password" title="Mostrar/Ocultar senha">Mostrar</button>
              </div>
            </label>
            <button type="submit" class="btn-primary">Entrar</button>
            <div id="login-result" class="result-message"></div>
          </form>

          <!-- Register Form -->
          <form id="register-form" class="auth-form">
            <label>
              Nome Completo
              <input type="text" name="name" placeholder="Seu nome" required />
            </label>
            <label>
              Email
              <input type="email" name="email" placeholder="seu.email@exemplo.com" required />
            </label>
            <label class="password-field">
              Senha
              <div class="password-wrapper">
                <input type="password" name="password" placeholder="Min. 6 caracteres" required minlength="6" />
                <button type="button" class="toggle-password" title="Mostrar/Ocultar senha">Mostrar</button>
              </div>
            </label>
            <label class="password-field">
              Confirmar Senha
              <div class="password-wrapper">
                <input type="password" name="confirm_password" placeholder="Digite a senha novamente" required minlength="6" />
                <button type="button" class="toggle-password" title="Mostrar/Ocultar senha">Mostrar</button>
              </div>
            </label>
            <button type="submit" class="btn-primary">Criar Conta</button>
            <div id="register-result" class="result-message"></div>
          </form>

          <div class="demo-info">
            <p><strong>ğŸ¯ Acesso Demo:</strong></p>
            <p>Email: <code>rh@demo.com</code> | Senha: <code>password</code></p>
          </div>
        </div>
      </div>
    </section>

    <!-- ========================================== -->
    <!-- PAINEL RH -->
    <!-- ========================================== -->
    
    <!-- Dashboard Gerencial RH -->
    <section id="rh-dashboard" class="view">
      <h2>ğŸ“Š Dashboard Gerencial</h2>
      
      <div class="dashboard-grid">
        <!-- VisÃ£o Geral -->
        <div class="dashboard-card">
          <h3>ğŸ“ˆ VisÃ£o Geral</h3>
          <div class="metric-row">
            <span>Total de FuncionÃ¡rios:</span>
            <strong id="dash-total-employees">0</strong>
          </div>
          <div class="metric-row">
            <span>Equipes Ativas:</span>
            <strong id="dash-total-teams">0</strong>
          </div>
          <div class="metric-row">
            <span>OS Pendentes:</span>
            <strong id="dash-pending-os">0</strong>
          </div>
          <div class="metric-row">
            <span>Mensagens Hoje:</span>
            <strong id="dash-messages-today">0</strong>
          </div>
        </div>

        <!-- Por Departamento -->
        <div class="dashboard-card">
          <h3>ğŸ‘¥ Por Departamento</h3>
          <div id="dept-chart" class="chart">
            <p class="muted">Carregando dados...</p>
          </div>
        </div>

        <!-- Aniversariantes -->
        <div class="dashboard-card">
          <h3>ğŸ“… Aniversariantes do MÃªs</h3>
          <div id="birthdays-list" class="birthdays-list">
            <p class="muted">Nenhum aniversariante este mÃªs</p>
          </div>
        </div>

        <!-- AÃ§Ãµes Pendentes -->
        <div class="dashboard-card">
          <h3>âš ï¸ AÃ§Ãµes Pendentes</h3>
          <div id="pending-actions" class="actions-list">
            <p class="muted">Nenhuma aÃ§Ã£o pendente</p>
          </div>
        </div>

        <!-- OS Timeline -->
        <div class="dashboard-card full-width">
          <h3>ğŸ“Š OS por Status (Ãšltimos 30 dias)</h3>
          <div id="os-timeline-chart" class="chart">
            <p class="muted">Carregando grÃ¡fico...</p>
          </div>
        </div>
      </div>
    </section>

    <!-- MÃ©tricas RH -->
    <section id="rh-metrics" class="view">
      <h2>Painel de MÃ©tricas de RH</h2>
      <div class="metrics-grid">
        <div class="metric-card">
          <h3>FuncionÃ¡rios Ativos</h3>
          <div class="metric-value" id="metric-employees">-</div>
        </div>
        <div class="metric-card">
          <h3>Equipes</h3>
          <div class="metric-value" id="metric-teams">-</div>
        </div>
        <div class="metric-card">
          <h3>OS Pendentes</h3>
          <div class="metric-value" id="metric-os-pending">-</div>
        </div>
        <div class="metric-card">
          <h3>SolicitaÃ§Ãµes</h3>
          <div class="metric-value" id="metric-requests">-</div>
        </div>
      </div>
    </section>

    <section id="rh-documents" class="view">
      <h2>Documentos para Alimentar IA</h2>
      <p class="subtitle">Upload de polÃ­ticas, procedimentos e documentos para melhorar o Chat RH</p>
      
      <div class="upload-area">
        <form id="document-form">
          <label>
            Nome do Documento
            <input type="text" name="title" placeholder="Ex: PolÃ­tica de FÃ©rias" required />
          </label>
          <label>
            DescriÃ§Ã£o
            <textarea name="description" placeholder="Do que se trata este documento?" required></textarea>
          </label>
          <label>
            Arquivo
            <input type="file" name="file" accept=".pdf,.doc,.docx,.txt" required />
          </label>
          <button type="submit" class="btn-primary">Enviar Documento</button>
        </form>
      </div>

      <div id="documents-list" class="documents-grid"></div>
    </section>

    <section id="rh-feed" class="view">
      <h2>Feed de Atividades</h2>
      <div id="activities-feed" class="activities-list"></div>
    </section>

    <!-- GESTÃƒO INTERNA DE RH -->
    <section id="rh-employees" class="view">
      <h2>ğŸ‘¥ GestÃ£o de FuncionÃ¡rios</h2>
      
      <div class="actions-bar">
        <button class="btn-primary" onclick="showAddEmployeeModal()">â• Adicionar FuncionÃ¡rio</button>
        <input type="text" id="search-employees" placeholder="ğŸ” Buscar funcionÃ¡rio..." class="search-input" />
        <select id="department-filter" class="filter-select">
          <option value="">Todos os Departamentos</option>
          <option value="TI">TI</option>
          <option value="RH">RH</option>
          <option value="Financeiro">Financeiro</option>
          <option value="Comercial">Comercial</option>
          <option value="OperaÃ§Ãµes">OperaÃ§Ãµes</option>
        </select>
      </div>

      <div id="employees-list" class="employees-grid"></div>
    </section>

    <section id="rh-teams" class="view">
      <h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ GestÃ£o de Equipes</h2>
      
      <div class="actions-bar">
        <button class="btn-primary" onclick="showCreateTeamModal()">â• Criar Nova Equipe</button>
      </div>

      <div id="teams-list" class="teams-grid">
        <!-- Teams will be loaded here -->
      </div>
    </section>

    <section id="rh-service-orders" class="view">
      <h2>ğŸ”§ Ordens de ServiÃ§o (OS)</h2>
      
      <div class="os-stats">
        <div class="stat-card">
          <h3>Abertas</h3>
          <div class="stat-value" id="os-open">0</div>
        </div>
        <div class="stat-card">
          <h3>Em Andamento</h3>
          <div class="stat-value" id="os-progress">0</div>
        </div>
        <div class="stat-card">
          <h3>ConcluÃ­das</h3>
          <div class="stat-value" id="os-closed">0</div>
        </div>
        <div class="stat-card">
          <h3>Total</h3>
          <div class="stat-value" id="os-total">0</div>
        </div>
      </div>

      <div class="actions-bar">
        <button class="btn-primary" onclick="showCreateOSModal()">â• Nova OS</button>
        <select id="os-status-filter" class="filter-select" onchange="filterOS()">
          <option value="">Todos os Status</option>
          <option value="aberta">Aberta</option>
          <option value="em_andamento">Em Andamento</option>
          <option value="concluida">ConcluÃ­da</option>
          <option value="cancelada">Cancelada</option>
        </select>
        <select id="os-category-filter" class="filter-select" onchange="filterOS()">
          <option value="">Todas as Categorias</option>
          <option value="TI">TI / InformÃ¡tica</option>
          <option value="Facilities">Facilities</option>
          <option value="RH">RH</option>
          <option value="Financeiro">Financeiro</option>
          <option value="Outros">Outros</option>
        </select>
      </div>

      <div id="os-list" class="os-grid"></div>
    </section>

    <!-- ========================================== -->
    <!-- PAINEL FUNCIONÃRIO -->
    <!-- ========================================== -->

    
    <!-- Dashboard do FuncionÃ¡rio -->
    <section id="employee-dashboard" class="view">
      <h2>ğŸ  Meu Dashboard</h2>
      
      <div class="employee-welcome-card">
        <div class="employee-photo-section">
          <div class="employee-photo-large">ğŸ‘¤</div>
          <div class="employee-welcome-info">
            <h3 id="emp-dash-name">Bem-vindo(a)!</h3>
            <p id="emp-dash-role" class="text-muted">Cargo</p>
            <p id="emp-dash-department" class="text-muted">Departamento</p>
          </div>
        </div>
      </div>

      <div class="dashboard-grid">
        <div class="dashboard-card">
          <h3>â° Horas Trabalhadas</h3>
          <div class="metric-value" id="emp-hours-month">0h</div>
          <p class="text-muted">Este mÃªs</p>
        </div>
        <div class="dashboard-card">
          <h3>ğŸ–ï¸ FÃ©rias DisponÃ­veis</h3>
          <div class="metric-value" id="emp-vacation-days">0</div>
          <p class="text-muted">Dias disponÃ­veis</p>
        </div>
        <div class="dashboard-card">
          <h3>ğŸ“ SolicitaÃ§Ãµes</h3>
          <div class="metric-value" id="emp-pending-requests">0</div>
          <p class="text-muted">Pendentes</p>
        </div>
        <div class="dashboard-card">
          <h3>ğŸ¯ Metas do MÃªs</h3>
          <div class="metric-value" id="emp-goals-progress">0%</div>
          <p class="text-muted">Progresso</p>
        </div>
      </div>

      <div class="dashboard-grid">
        <div class="dashboard-card full-width">
          <h3>ğŸ“… Ãšltimos Registros de Ponto</h3>
          <div id="emp-recent-timesheets" class="recent-list"></div>
        </div>
      </div>
    </section>

    <!-- Perfil do FuncionÃ¡rio -->
    <section id="employee-profile" class="view">
      <h2>ğŸ‘¤ Meu Perfil</h2>
      
      <div class="profile-grid">
        <div class="profile-card">
          <h3>ğŸ“‹ InformaÃ§Ãµes Pessoais</h3>
          <div class="profile-info">
            <div class="info-row">
              <span>Nome Completo:</span>
              <strong id="prof-name">-</strong>
            </div>
            <div class="info-row">
              <span>Email:</span>
              <strong id="prof-email">-</strong>
            </div>
            <div class="info-row">
              <span>Telefone:</span>
              <strong id="prof-phone">-</strong>
            </div>
            <div class="info-row">
              <span>CPF:</span>
              <strong id="prof-cpf">-</strong>
            </div>
            <div class="info-row">
              <span>Data de Nascimento:</span>
              <strong id="prof-birthday">-</strong>
            </div>
          </div>
          <button class="btn-primary" onclick="editPersonalInfo()">âœï¸ Editar InformaÃ§Ãµes</button>
        </div>

        <div class="profile-card">
          <h3>ğŸ’¼ InformaÃ§Ãµes Profissionais</h3>
          <div class="profile-info">
            <div class="info-row">
              <span>Cargo:</span>
              <strong id="prof-position">-</strong>
            </div>
            <div class="info-row">
              <span>Departamento:</span>
              <strong id="prof-dept">-</strong>
            </div>
            <div class="info-row">
              <span>Data de AdmissÃ£o:</span>
              <strong id="prof-admission">-</strong>
            </div>
            <div class="info-row">
              <span>Tipo de Contrato:</span>
              <strong id="prof-contract">-</strong>
            </div>
            <div class="info-row">
              <span>Gestor Direto:</span>
              <strong id="prof-manager">-</strong>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SolicitaÃ§Ãµes -->
    <section id="employee-requests" class="view">
      <h2>ğŸ“ Minhas SolicitaÃ§Ãµes</h2>
      
      <div class="actions-bar">
        <button class="btn-primary" onclick="showNewRequestModal()">â• Nova SolicitaÃ§Ã£o</button>
        <select id="request-status-filter" class="filter-select" onchange="filterRequests()">
          <option value="">Todos os Status</option>
          <option value="pendente">Pendente</option>
          <option value="aprovado">Aprovado</option>
          <option value="rejeitado">Rejeitado</option>
        </select>
      </div>

      <div id="requests-list" class="requests-grid"></div>
    </section>

    <!-- Registro de Ponto -->
    <section id="employee-timesheet" class="view">
      <h2>â° Registro de Ponto</h2>
      
      <div class="timesheet-actions">
        <div class="clock-card">
          <h3>Registrar Ponto Agora</h3>
          <div class="current-time" id="current-time">00:00:00</div>
          <div class="timesheet-buttons">
            <button class="btn-primary btn-large" onclick="clockIn()">ğŸŸ¢ Entrada</button>
            <button class="btn-secondary btn-large" onclick="clockOut()">ğŸ”´ SaÃ­da</button>
          </div>
          <div id="last-clock" class="text-muted"></div>
        </div>
      </div>

      <div class="timesheet-summary">
        <h3>ğŸ“Š Resumo do MÃªs</h3>
        <div class="summary-grid">
          <div class="summary-item">
            <span>Total de Horas:</span>
            <strong id="timesheet-total-hours">0h</strong>
          </div>
          <div class="summary-item">
            <span>Dias Trabalhados:</span>
            <strong id="timesheet-days-worked">0</strong>
          </div>
          <div class="summary-item">
            <span>Horas Extras:</span>
            <strong id="timesheet-overtime">0h</strong>
          </div>
        </div>
      </div>

      <div class="timesheet-calendar">
        <h3>ğŸ“… HistÃ³rico</h3>
        <div id="timesheet-history" class="timesheet-list"></div>
      </div>
    </section>

    <!-- Metas e Desempenho -->
    <section id="employee-goals" class="view">
      <h2>ğŸ¯ Metas & Desempenho</h2>
      
      <div class="goals-overview">
        <div class="goal-card">
          <h3>Metas do MÃªs Atual</h3>
          <div class="progress-circle">
            <div class="progress-value" id="goals-progress">0%</div>
          </div>
          <p class="text-muted">Progresso geral</p>
        </div>
      </div>

      <div class="goals-list">
        <h3>ğŸ“‹ Minhas Metas</h3>
        <div id="active-goals" class="goals-grid"></div>
      </div>

      <div class="performance-section">
        <h3>ğŸ“ˆ AvaliaÃ§Ãµes de Desempenho</h3>
        <div id="performance-reviews" class="reviews-list"></div>
      </div>
    </section>

    <!-- Documentos do FuncionÃ¡rio -->
    <section id="employee-documents" class="view">
      <h2>ğŸ“ Meus Documentos</h2>
      
      <div class="documents-categories">
        <div class="doc-category">
          <h3>ğŸ’° Holerites</h3>
          <div id="payslips-list" class="documents-list"></div>
        </div>

        <div class="doc-category">
          <h3>ğŸ“„ Contratos</h3>
          <div id="contracts-list" class="documents-list"></div>
        </div>

        <div class="doc-category">
          <h3>ğŸ“¢ Comunicados</h3>
          <div id="announcements-list" class="documents-list"></div>
        </div>

        <div class="doc-category">
          <h3>ğŸ“ Outros Documentos</h3>
          <div id="other-docs-list" class="documents-list"></div>
        </div>
      </div>
    </section>

    <!-- Chat com IA -->
    <section id="employee-chat" class="view">
      <h2>ğŸ¤– Chat com Assistente IA do RH</h2>
      <p class="subtitle">Tire suas dÃºvidas sobre polÃ­ticas, benefÃ­cios, procedimentos e mais!</p>
      
      <div class="chat-container-full">
        <div id="chat-messages" class="chat-messages-full"></div>
        <form id="chat-form" class="chat-input-full">
          <input type="text" id="chat-input" placeholder="Digite sua dÃºvida..." required />
          <button type="submit" class="btn-primary">ğŸ“¤ Enviar</button>
        </form>
      </div>
    </section>

    <!-- 5. ADMIN PORTAL -->
    <section id="admin-dashboard" class="view">
      <h2>Dashboard Administrativo</h2>
      <div class="admin-metrics-grid">
        <div class="admin-card">
          <h3>UsuÃ¡rios Totais</h3>
          <div class="big-number" id="admin-total-users">-</div>
        </div>
        <div class="admin-card">
          <h3>RHs Ativos</h3>
          <div class="big-number" id="admin-rhs">-</div>
        </div>
        <div class="admin-card">
          <h3>FuncionÃ¡rios</h3>
          <div class="big-number" id="admin-employees">-</div>
        </div>
        <div class="admin-card">
          <h3>Status do Sistema</h3>
          <div class="big-number" id="admin-status">âœ… Online</div>
        </div>
      </div>
    </section>

    <section id="admin-users" class="view">
      <h2>Gerenciar UsuÃ¡rios</h2>
      <div id="admin-users-list" class="users-table"></div>
    </section>

    <section id="admin-system" class="view">
      <h2>ConfiguraÃ§Ãµes do Sistema</h2>
      <div class="settings-container">
        <div class="setting-item">
          <h3>Banco de Dados</h3>
          <p id="db-info">-</p>
        </div>
        <div class="setting-item">
          <h3>API</h3>
          <button id="test-api-btn" class="btn-secondary">Testar API</button>
          <p id="api-status">-</p>
        </div>
      </div>
    </section>

  </main>
  </div>

  <script src="/app.js"></script>
</body>
</html>
